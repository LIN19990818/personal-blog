# 全量功能测试问题报告 v1.0

**测试日期**: 2026-02-17  
**测试人员**: AI Tester  
**测试环境**: Windows 11, Chrome 144, Node.js 18+, Java 17  

---

## 一、测试概述

本次测试对个人博客系统进行全面功能测试，覆盖前台展示、后台管理、API接口等模块。

### 1.1 测试范围

| 模块 | 测试内容 | 测试状态 |
|------|----------|----------|
| 人间足迹页面 | 图片加载、显示、交互 | ❌ 异常 |
| 人生地图页面 | 地图渲染、城市标记显示 | ❌ 异常 |
| 音乐播放器 | 播放器显示、播放功能 | ❌ 异常 |
| 后台管理模块 | 图片/音乐/城市管理 | ✅ 正常 |
| 文章管理 | 新建/保存/发布 | ⚠️ 部分异常 |
| 首页 | 文章列表显示 | ✅ 正常 |
| 后台登录 | 登录功能 | ✅ 正常 |

### 1.2 问题统计

| 优先级 | 问题数量 | 占比 |
|--------|----------|------|
| P0 - 阻塞 | 3 | 50% |
| P1 - 严重 | 1 | 17% |
| P2 - 一般 | 2 | 33% |
| **总计** | **6** | **100%** |

---

## 二、问题详情

### 2.1 【P0】人间足迹页面图片不显示

**模块归属**: 前台展示 - Gallery  
**严重程度**: P0 - 阻塞  
**影响范围**: 用户无法查看图片  

#### 异常表现
- 页面显示"暂无图片"
- 图片数量显示为 0
- 后端 API 返回 12 张图片数据，但前端未正确渲染

#### 报错信息
无控制台报错，但数据未正确加载到页面。

#### 可复现步骤
1. 访问 http://localhost:3000/gallery
2. 观察页面显示"暂无图片"
3. 检查网络请求，API 返回数据正常

#### 根因分析
前端代码 `Gallery.tsx` 第 18-19 行：
```typescript
const response = await imageApi.getAll()
if (response.data) {
  setImages(response.data)
}
```

问题：`request.get()` 方法已经返回 `res.data.data`，即直接返回数组数据。但代码中又尝试访问 `response.data`，导致数据为 `undefined`。

#### 修复建议
修改数据获取逻辑：
```typescript
const response = await imageApi.getAll()
if (response) {
  setImages(response)
}
```

---

### 2.2 【P0】人生地图页面城市标记不显示

**模块归属**: 前台展示 - MapPage  
**严重程度**: P0 - 阻塞  
**影响范围**: 用户无法查看已访问的城市标记  

#### 异常表现
- 地图正常渲染
- 城市标记点不显示
- 后端 API 返回 12 个城市数据，但前端未正确渲染

#### 报错信息
无控制台报错。

#### 可复现步骤
1. 访问 http://localhost:3000/map
2. 观察地图渲染正常，但无城市标记
3. 检查网络请求，API 返回数据正常

#### 根因分析
前端代码 `MapPage.tsx` 第 31-33 行：
```typescript
const response = await cityApi.getAll()
if (response.data) {
  setCities(response.data)
}
```

问题同上：`request.get()` 已返回数组数据，代码中 `response.data` 为 `undefined`。

#### 修复建议
修改数据获取逻辑：
```typescript
const response = await cityApi.getAll()
if (response) {
  setCities(response)
}
```

---

### 2.3 【P0】音乐播放器不显示

**模块归属**: 前台展示 - MusicPlayer  
**严重程度**: P0 - 阻塞  
**影响范围**: 用户无法使用音乐播放功能  

#### 异常表现
- 首页底部无音乐播放器显示
- 后端 API 返回 10 首音乐数据

#### 报错信息
无控制台报错。

#### 可复现步骤
1. 访问 http://localhost:3000/
2. 观察页面底部无音乐播放器
3. 检查网络请求，API 返回数据正常

#### 根因分析
前端代码 `MusicPlayer.tsx` 第 36-39 行：
```typescript
const response = await musicApi.getAll()
if (response.data && response.data.length > 0) {
  setPlaylist(response.data)
}
```

问题同上：`request.get()` 已返回数组数据，代码中 `response.data` 为 `undefined`。

#### 修复建议
修改数据获取逻辑：
```typescript
const response = await musicApi.getAll()
if (response && response.length > 0) {
  setPlaylist(response)
}
```

---

### 2.4 【P1】新建文章保存失败

**模块归属**: 后台管理 - 文章管理  
**严重程度**: P1 - 严重  
**影响范围**: 用户无法正常创建文章  

#### 异常表现
- 填写标题后点击"保存草稿"
- 提示"保存失败，请检查表单"

#### 报错信息
API 返回：
```json
{"code":40001,"message":"文章内容不能为空, 分类ID不能为空","data":null}
```

#### 可复现步骤
1. 登录后台 http://localhost:3000/admin
2. 进入文章管理 -> 新建文章
3. 仅填写标题，点击"保存草稿"
4. 观察保存失败提示

#### 根因分析
后端验证要求：
1. 文章内容不能为空
2. 分类ID不能为空

前端表单验证提示不够明确，用户不知道需要填写哪些必填字段。

#### 修复建议
1. 前端增加表单验证提示
2. 标注必填字段（标题、内容、分类）
3. 提交前进行前端校验

---

### 2.5 【P2】API 响应处理不一致

**模块归属**: 前端架构  
**严重程度**: P2 - 一般  
**影响范围**: 多个页面数据加载失败  

#### 异常表现
多个页面使用 `response.data` 获取数据，但实际应该直接使用 `response`。

#### 根因分析
`request.ts` 中的请求方法：
```typescript
get<T>(url: string, config?: AxiosRequestConfig): Promise<T> {
  return instance.get(url, config).then((res) => res.data.data)
}
```

返回的是 `res.data.data`，即直接返回业务数据。

但部分页面代码仍使用 `response.data` 访问数据，导致获取到 `undefined`。

#### 修复建议
统一 API 响应处理方式，修改所有使用 `response.data` 的代码。

---

### 2.6 【P2】后端管理模块菜单显示正常

**模块归属**: 后台管理  
**严重程度**: 无  
**状态**: ✅ 正常  

#### 测试结果
- 图片管理菜单：✅ 显示正常
- 城市管理菜单：✅ 显示正常
- 音乐管理菜单：✅ 显示正常
- 菜单导航：✅ 功能正常

---

## 三、问题优先级排序

| 序号 | 问题 | 优先级 | 影响模块 |
|------|------|--------|----------|
| 1 | 人间足迹页面图片不显示 | P0 | Gallery |
| 2 | 人生地图页面城市标记不显示 | P0 | MapPage |
| 3 | 音乐播放器不显示 | P0 | MusicPlayer |
| 4 | 新建文章保存失败 | P1 | ArticleCreate |
| 5 | API响应处理不一致 | P2 | 架构层面 |

---

## 四、修复优先级建议

### 第一批（立即修复）
1. 修复 Gallery.tsx 数据获取逻辑
2. 修复 MapPage.tsx 数据获取逻辑
3. 修复 MusicPlayer.tsx 数据获取逻辑

### 第二批（后续优化）
1. 优化文章创建表单验证提示
2. 统一 API 响应处理规范

---

## 五、测试结论

本次测试发现 **3 个 P0 级别问题**，均由 API 响应处理逻辑错误导致。建议立即修复后再进行复测。

**测试通过率**: 40%（4/10 功能正常）

---

**报告生成时间**: 2026-02-17 14:25:00  
**下一步**: 修复高优先级问题后进行复测
