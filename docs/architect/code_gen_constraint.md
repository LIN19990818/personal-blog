# 代码生成刚性约束清单

**文档版本**：v1.0.0  
**创建日期**：2026-02-15  
**创建者**：Architect智能体  
**适用对象**：Coder智能体  
**状态**：🔒 已锁定

---

## 一、约束概述

本文档是Coder智能体进行代码实现时必须严格遵守的刚性约束清单。所有约束均为强制性要求，**无例外、无妥协**。

---

## 二、禁止项（绝对禁止）

### 2.1 架构禁止项

| 编号 | 禁止项 | 说明 |
|------|--------|------|
| A-01 | 禁止修改项目目录结构 | 必须严格按照 `blog_architecture_v1.0.0.md` 定义的目录结构 |
| A-02 | 禁止新增未定义的模块 | 所有模块必须在PRD和架构文档中有定义 |
| A-03 | 禁止修改数据库表结构 | 必须严格按照 `schema.sql` 定义的表结构 |
| A-04 | 禁止修改API接口契约 | 必须严格按照架构文档定义的接口规范 |
| A-05 | 禁止引入未定义的依赖 | 所有依赖必须在技术选型清单中 |

### 2.2 安全禁止项

| 编号 | 禁止项 | 说明 |
|------|--------|------|
| S-01 | 禁止硬编码敏感信息 | 密码、密钥、Token等必须使用环境变量 |
| S-02 | 禁止明文存储密码 | 必须使用BCrypt加密 |
| S-03 | 禁止在前端存储敏感信息 | Token除外，其他敏感信息禁止localStorage |
| S-04 | 禁止绕过鉴权机制 | 后台接口必须经过JwtFilter验证 |
| S-05 | 禁止拼接SQL语句 | 必须使用JPA参数化查询 |

### 2.3 代码禁止项

| 编号 | 禁止项 | 说明 |
|------|--------|------|
| C-01 | 禁止使用any类型（TypeScript） | 必须定义明确的类型 |
| C-02 | 禁止使用var声明变量 | 必须使用const/let |
| C-03 | 禁止内联样式（除特殊情况） | 必须使用Tailwind CSS类名 |
| C-04 | 禁止console.log提交到代码 | 开发调试后必须删除 |
| C-05 | 禁止未处理的Promise | 必须使用try-catch或.catch() |
| C-06 | 禁止未处理的异常 | 必须使用GlobalExceptionHandler |

### 2.4 功能禁止项

| 编号 | 禁止项 | 说明 |
|------|--------|------|
| F-01 | 禁止实现PRD排除的功能 | 用户注册、评论、点赞等15项功能禁止实现 |
| F-02 | 禁止新增PRD未提及的功能 | 所有功能必须在PRD中有定义 |
| F-03 | 禁止修改PRD定义的业务逻辑 | 业务逻辑必须100%对齐PRD |

---

## 三、必须遵守项（强制执行）

### 3.1 命名规范

| 编号 | 规范 | 示例 |
|------|------|------|
| N-01 | 组件名使用PascalCase | `ArticleList.tsx` |
| N-02 | 函数名使用camelCase | `getArticleList()` |
| N-03 | 常量使用UPPER_SNAKE_CASE | `API_BASE_URL` |
| N-04 | CSS类名使用kebab-case | `article-card` |
| N-05 | 文件名使用kebab-case或PascalCase | `article-service.ts` 或 `ArticleService.java` |
| N-06 | 接口/类型使用PascalCase，以I开头 | `IArticle` |
| N-07 | Java类名使用PascalCase | `ArticleController.java` |
| N-08 | Java方法名使用camelCase | `getArticleById()` |
| N-09 | Java变量名使用camelCase | `articleList` |
| N-10 | Java常量使用UPPER_SNAKE_CASE | `DEFAULT_PAGE_SIZE` |

### 3.2 目录规范

| 编号 | 规范 |
|------|------|
| D-01 | 前端代码必须在 `/code/frontend/` 目录下 |
| D-02 | 后端代码必须在 `/code/backend/` 目录下 |
| D-03 | 数据库脚本必须在 `/sql/` 目录下 |
| D-04 | 部署文件必须在 `/deploy/` 目录下 |
| D-05 | 组件必须按功能模块分目录存放 |
| D-06 | 公共组件必须放在 `/components/common/` 目录下 |

### 3.3 接口规范

| 编号 | 规范 |
|------|------|
| I-01 | 所有接口必须返回统一格式 `{code, message, data}` |
| I-02 | 分页接口必须返回 `{list, total, page, size, totalPages}` |
| I-03 | 后台接口必须添加 `@RequestMapping("/api/admin")` 前缀 |
| I-04 | 前台接口必须添加 `@RequestMapping("/api")` 前缀 |
| I-05 | 所有接口必须有参数校验 |
| I-06 | 所有接口必须有错误处理 |
| I-07 | RESTful规范：GET查询、POST创建、PUT更新、DELETE删除 |

### 3.4 安全规范

| 编号 | 规范 |
|------|------|
| SEC-01 | 后台接口必须添加 `@PreAuthorize` 或JWT验证 |
| SEC-02 | 密码必须使用 `BCryptPasswordEncoder` 加密 |
| SEC-03 | JWT密钥必须从环境变量读取 |
| SEC-04 | 数据库密码必须从环境变量读取 |
| SEC-05 | 文件上传必须校验文件类型和大小 |
| SEC-06 | Markdown渲染必须使用DOMPurify过滤 |

### 3.5 代码规范

| 编号 | 规范 |
|------|------|
| CODE-01 | 前端代码必须通过ESLint检查 |
| CODE-02 | 后端代码必须通过Checkstyle检查 |
| CODE-03 | 关键逻辑必须有注释说明 |
| CODE-04 | 函数必须有明确的返回类型 |
| CODE-05 | 复杂条件判断必须提取为语义化变量 |
| CODE-06 | 魔法数字必须定义为常量 |
| CODE-07 | 重复代码必须提取为公共函数/组件 |

### 3.6 Git规范

| 编号 | 规范 |
|------|------|
| G-01 | 提交信息必须遵循 Conventional Commits |
| G-02 | feat: 新功能 |
| G-03 | fix: 修复bug |
| G-04 | docs: 文档更新 |
| G-05 | style: 代码格式调整 |
| G-06 | refactor: 重构 |
| G-07 | test: 测试相关 |
| G-08 | chore: 构建/工具相关 |

---

## 四、技术栈约束

### 4.1 前端技术栈（必须使用）

| 技术 | 版本 | 用途 |
|------|------|------|
| React | 18.2.x | UI框架 |
| TypeScript | 5.0.x | 类型安全 |
| Vite | 5.0.x | 构建工具 |
| React Router | 6.20.x | 路由管理 |
| Zustand | 4.4.x | 状态管理 |
| Axios | 1.6.x | HTTP请求 |
| Ant Design | 5.12.x | UI组件库 |
| Tailwind CSS | 3.4.x | 样式方案 |
| ByteMD | 0.20.x | Markdown编辑器 |
| react-markdown | 9.0.x | Markdown渲染 |
| Prism.js | 1.29.x | 代码高亮 |
| react-helmet | 6.1.x | SEO |

### 4.2 后端技术栈（必须使用）

| 技术 | 版本 | 用途 |
|------|------|------|
| Spring Boot | 3.2.x | 后端框架 |
| JDK | 17 | 运行环境 |
| Spring Data JPA | 3.2.x | 数据访问 |
| MySQL | 8.0.x | 数据库 |
| HikariCP | 5.0.x | 连接池 |
| jjwt | 0.12.x | JWT认证 |
| Hibernate Validator | 8.0.x | 参数校验 |
| SpringDoc OpenAPI | 2.3.x | API文档 |
| Maven | 3.9.x | 构建工具 |

### 4.3 禁止使用的技术

| 技术 | 原因 |
|------|------|
| jQuery | 已使用React，无需jQuery |
| Redux | 已选择Zustand，避免复杂度 |
| Moment.js | 使用原生Date或dayjs |
| Lodash | 大部分功能可用原生JS实现 |
| Bootstrap | 已使用Tailwind CSS |

---

## 五、数据库约束

### 5.1 表结构约束

| 编号 | 约束 |
|------|------|
| DB-01 | 主键必须使用BIGINT AUTO_INCREMENT |
| DB-02 | 必须有created_at字段，默认CURRENT_TIMESTAMP |
| DB-03 | 更新表必须有updated_at字段，自动更新 |
| DB-04 | 字符集必须使用utf8mb4 |
| DB-05 | 排序规则必须使用utf8mb4_unicode_ci |
| DB-06 | 外键必须添加约束名 |
| DB-07 | 必须添加必要的索引 |

### 5.2 字段类型约束

| 场景 | 必须使用 |
|------|----------|
| 主键 | BIGINT |
| 字符串 | VARCHAR(n) |
| 长文本 | LONGTEXT |
| 状态值 | TINYINT |
| 时间 | DATETIME |
| 布尔 | TINYINT(1) |

---

## 六、性能约束

| 编号 | 约束 | 指标 |
|------|------|------|
| P-01 | 接口响应时间 | P95 < 300ms |
| P-02 | 首屏加载时间 | < 2s |
| P-03 | 分页大小 | 默认10，最大50 |
| P-04 | 图片大小 | 单张最大5MB |
| P-05 | 文章内容 | 最大1MB |

---

## 七、验收标准

### 7.1 代码验收

| 检查项 | 验收标准 |
|--------|----------|
| ESLint | 无Error，Warning < 10 |
| TypeScript | 无any类型，无类型错误 |
| 编译 | 前后端代码编译通过 |
| 测试 | 核心功能测试通过 |

### 7.2 功能验收

| 检查项 | 验收标准 |
|--------|----------|
| PRD覆盖 | 26个功能点100%实现 |
| 接口实现 | 26个接口100%实现 |
| 页面实现 | 14个页面100%实现 |

### 7.3 安全验收

| 检查项 | 验收标准 |
|--------|----------|
| 鉴权 | 未登录访问后台返回401 |
| 密码加密 | 数据库密码为BCrypt加密值 |
| SQL注入 | SQLMap扫描无漏洞 |
| XSS | 安全扫描无漏洞 |

---

## 八、约束检查清单

Coder智能体在提交代码前必须逐项检查以下清单：

### 8.1 架构检查

- [ ] 目录结构是否符合架构文档定义
- [ ] 是否引入了未定义的依赖
- [ ] 是否修改了数据库表结构
- [ ] 是否修改了API接口契约

### 8.2 安全检查

- [ ] 是否有硬编码的敏感信息
- [ ] 密码是否使用BCrypt加密
- [ ] 后台接口是否有鉴权
- [ ] 是否有SQL拼接

### 8.3 代码检查

- [ ] ESLint是否通过
- [ ] TypeScript是否有any类型
- [ ] 是否有未处理的异常
- [ ] 是否有console.log

### 8.4 功能检查

- [ ] 是否实现了PRD排除的功能
- [ ] 是否新增了PRD未提及的功能
- [ ] 业务逻辑是否对齐PRD

---

## 九、违规处理

| 违规级别 | 处理方式 |
|----------|----------|
| 严重违规（安全/架构） | 立即回滚，重新实现 |
| 一般违规（代码规范） | 修改后重新提交 |
| 轻微违规（注释缺失） | 补充后提交 |

---

**文档状态**：🔒 已锁定  
**适用范围**：所有代码实现工作  
**更新规则**：仅Architect智能体可更新，需版本升级
